import{_ as a,C as n,o as i,c as o,ae as s,E as l,w as r,a as d}from"./chunks/framework.f9sx20OT.js";const b=JSON.parse('{"title":"Open API Guide","description":"","frontmatter":{},"headers":[],"relativePath":"reference/open-api.md","filePath":"reference/open-api.md","lastUpdated":1769480114000}'),c={name:"reference/open-api.md"};function p(u,e,h,g,f,m){const t=n("callout");return i(),o("div",null,[e[1]||(e[1]=s(`<h1 id="open-api-guide" tabindex="-1">Open API Guide <a class="header-anchor" href="#open-api-guide" aria-label="Permalink to &quot;Open API Guide&quot;">â€‹</a></h1><p>PieMDM provides a powerful OpenAPI that allows external systems to access master data through secure authentication. The OpenAPI uses an HMAC-SHA256 signature mechanism based on Canonical Request to ensure the authenticity and integrity of requests.</p><h2 id="_1-authentication-mechanism" tabindex="-1">1. Authentication Mechanism <a class="header-anchor" href="#_1-authentication-mechanism" aria-label="Permalink to &quot;1. Authentication Mechanism&quot;">â€‹</a></h2><p>All OpenAPI requests must carry the following authentication parameters in the Header:</p><table tabindex="0"><thead><tr><th style="text-align:left;">Header Parameter</th><th style="text-align:left;">Description</th><th style="text-align:left;">Example</th></tr></thead><tbody><tr><td style="text-align:left;"><code>X-App-Id</code></td><td style="text-align:left;">App Identifier, obtained in &quot;App Management&quot;</td><td style="text-align:left;"><code>app_592837482...</code></td></tr><tr><td style="text-align:left;"><code>X-Timestamp</code></td><td style="text-align:left;">Unix timestamp (seconds) when the request was sent</td><td style="text-align:left;"><code>1674829374</code></td></tr><tr><td style="text-align:left;"><code>X-Nonce</code></td><td style="text-align:left;">A random string of at least 16 characters used to prevent replay attacks</td><td style="text-align:left;"><code>abcdef1234567890</code></td></tr><tr><td style="text-align:left;"><code>X-Sign</code></td><td style="text-align:left;">Digest value calculated based on the signature algorithm (Hex encoded)</td><td style="text-align:left;"><code>a1b2c3d4...</code></td></tr></tbody></table><h3 id="_1-1-signature-algorithm" tabindex="-1">1.1 Signature Algorithm <a class="header-anchor" href="#_1-1-signature-algorithm" aria-label="Permalink to &quot;1.1 Signature Algorithm&quot;">â€‹</a></h3><p>The signature calculation process is as follows:</p><ol><li><p><strong>Construct Canonical Request String</strong>: Format with parts connected by newline <code>\\n</code>:</p><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>HTTPMethod + &quot;\\n&quot; +</span></span>
<span class="line"><span>CanonicalURI + &quot;\\n&quot; +</span></span>
<span class="line"><span>CanonicalQueryString + &quot;\\n&quot; +</span></span>
<span class="line"><span>SHA256(RequestBody) + &quot;\\n&quot; +</span></span>
<span class="line"><span>X-Timestamp + &quot;\\n&quot; +</span></span>
<span class="line"><span>X-Nonce</span></span></code></pre></div><ul><li><strong>HTTPMethod</strong>: Uppercase HTTP method, such as <code>GET</code> or <code>POST</code>.</li><li><strong>CanonicalURI</strong>: The full path of the request, must start with <code>/</code>, e.g., <code>/openapi/v1/entities/users</code>.</li><li><strong>CanonicalQueryString</strong>: Sorted query parameter string. Sort by parameter name in ASCII ascending order, format is <code>key1=value1&amp;key2=value2</code>.</li><li><strong>SHA256(RequestBody)</strong>: SHA256 hash value (lowercase Hex) of the request body. If Body is empty, the hash is: <code>e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855</code>.</li><li><strong>X-Timestamp</strong> and <strong>X-Nonce</strong>: Must be strictly consistent with the values in the Header.</li></ul></li><li><p><strong>Calculate Signature</strong>: Use aggregate&#39;s <code>AppSecret</code> as the Key to perform HMAC-SHA256 calculation on the above canonical string:</p><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Signature = Hex(HMAC-SHA256(AppSecret, CanonicalRequest))</span></span></code></pre></div></li></ol><h2 id="_2-security-policy" tabindex="-1">2. Security Policy <a class="header-anchor" href="#_2-security-policy" aria-label="Permalink to &quot;2. Security Policy&quot;">â€‹</a></h2><p>In addition to signature verification, OpenAPI also provides multiple security guarantees:</p><ul><li><strong>IP Whitelist</strong>: Only IP addresses configured in the &quot;App Management&quot; whitelist can successfully call the interface.</li><li><strong>Permission Audit</strong>: All OpenAPI calls are recorded in detail, including request parameters, response results, call duration, etc.</li><li><strong>Nonce Anti-Replay</strong>: Each Nonce can only be used once. The system caches recently used Nonces, and repeated submissions will return <code>401 Unauthorized</code>.</li><li><strong>Time Window Verification</strong>: Requests where the deviation between <code>X-Timestamp</code> and the server&#39;s current time exceeds 5 minutes will be rejected.</li></ul><h2 id="_3-core-interface" tabindex="-1">3. Core Interface <a class="header-anchor" href="#_3-core-interface" aria-label="Permalink to &quot;3. Core Interface&quot;">â€‹</a></h2><p>The base path for all interfaces is: <code>/openapi/v1</code></p><h3 id="_3-1-get-entity-list" tabindex="-1">3.1 Get Entity List <a class="header-anchor" href="#_3-1-get-entity-list" aria-label="Permalink to &quot;3.1 Get Entity List&quot;">â€‹</a></h3><p><strong>GET</strong> <code>/openapi/v1/entities/{table_code}</code></p><p><strong>Query Parameters</strong>:</p><ul><li><code>page</code>: Page number, default 1</li><li><code>pageSize</code>: Number per page, default 15, max 100</li><li><code>id</code>: Optional, exact ID filter</li><li><code>status</code>: Optional, status filter</li><li><code>created_at</code>: Optional, creation time filter</li></ul><h3 id="_3-2-get-entity-details" tabindex="-1">3.2 Get Entity Details <a class="header-anchor" href="#_3-2-get-entity-details" aria-label="Permalink to &quot;3.2 Get Entity Details&quot;">â€‹</a></h3><p><strong>GET</strong> <code>/openapi/v1/entities/{table_code}/{id}</code></p><h2 id="_4-error-code-reference" tabindex="-1">4. Error Code Reference <a class="header-anchor" href="#_4-error-code-reference" aria-label="Permalink to &quot;4. Error Code Reference&quot;">â€‹</a></h2><table tabindex="0"><thead><tr><th style="text-align:left;">Error Message</th><th style="text-align:left;">Description</th></tr></thead><tbody><tr><td style="text-align:left;"><code>AUTH_FAILED</code></td><td style="text-align:left;"><code>X-App-Id</code> invalid or missing</td></tr><tr><td style="text-align:left;"><code>SIGNATURE_INVALID</code></td><td style="text-align:left;">Signature verification failed</td></tr><tr><td style="text-align:left;"><code>TOKEN_EXPIRED</code></td><td style="text-align:left;">Timestamp timeout or Nonce has been used</td></tr><tr><td style="text-align:left;"><code>IP_NOT_ALLOWED</code></td><td style="text-align:left;">Client IP is not in the whitelist</td></tr><tr><td style="text-align:left;"><code>PERMISSION_DENIED</code></td><td style="text-align:left;">App has no permission to access the specified entity table</td></tr></tbody></table>`,21)),l(t,{emoji:"ðŸ’¡","background-color":"light-blue","border-color":"blue"},{default:r(()=>[...e[0]||(e[0]=[d(" Tip: More interfaces (such as creating and modifying entities) are under development. If you have urgent needs, please contact technical support. ",-1)])]),_:1})])}const x=a(c,[["render",p]]);export{b as __pageData,x as default};
