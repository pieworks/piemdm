# 審批流管理

PieMDM 內置了強大的審批引擎，支持企業根據業務需求靈活配置審批流程。無論是物料主數據的創建、供應商檔案的修改，還是財務數據的凍結，都可以通過審批流來確保數據的準確性和合規性。

同時也支持對接外部審批系統：
- 飛書 (已支持)
- 釘釘
- 企業微信
- 其他

## 核心概念

系統的審批架構主要由以下部分組成的：
- **審批定義 (Approval Definition)**：流程的模板，定義了審批名稱、關聯表單和節點序列。
- **流程節點 (Approval Node)**：流程中的具體環節，規定了誰來審、怎麼審。
- **審批實例 (Approval Instance)**：流程的具體執行記錄，對應一張具體的審批單據。
- **審批任務 (Approval Task)**：分配給具體執行人的待辦事項。

## 流程節點類型

在配置審批流時，您可以組合使用多種類型的節點：

| 節點類型 | 說明 |
| :--- | :--- |
| **開始節點 (START)** | 流程的入口，通常由申請人發起。 |
| **審批節點 (APPROVAL)** | 核心節點，需要審核人進行通過或駁回操作。 |
| **抄送節點 (CC)** | 告知相關人員，無需操作，僅供查閱。 |
| **條件節點 (CONDITION)** | 邏輯分支，根據表單數據自動選擇路徑（如：金額 > 10,000 走向經理審批）。 |
| **並行/合併節點** | 支持多個環節同時進行審批，並在匯合後繼續。 |
| **結束節點 (END)** | 流程終點，通過後數據將正式生效。 |

## 審批方式

對於審批節點，您可以配置不同的決策模式：
- **或簽 (OR)**：節點內的多名審批人，只需一人通過即可進入下一環節。
- **會簽 (AND)**：節點內的所有審批人均需通過，流程方可繼續。
- **順序審批 (SEQUENTIAL)**：按照預定義的順序，逐一進行審批。

## 審批人設置

審批人可以基於多種維度進行配置：
- **指定用戶**：選擇特定的系統用戶。
- **指定角色**：分配給擁有特定角色（如“財務經理”）的所有用戶。
- **上級領導**：動態獲取申請人的直接或間接上級。
- **自選環節**：由上一環節的審批人臨時指定下一環節的執行者。

## 數據流轉機制

### 1. 草稿數據隔離
當一個表關聯了審批流時，新增或修改的數據首先存儲在“草稿狀態”。此時數據在業務系統中不可見，僅在審批模塊中流轉。

### 2. 生效策略
- **審批通過**：流程到達“結束節點”且最終通過後，系統會自動將草稿數據同步到正式業務表中，主數據正式生效。
- **審批駁回**：流程終止，申請人可以根據審批意見修改後再次提交，或撤回申請。

## 最佳實踐

1. **簡化路徑**：對於常規、低風險的操作，儘量縮短審批路徑以提高效率。
2. **明確節點命名**：使用具有業務含義的節點名稱（如“一審：部門主管”），方便參與者理解當前進度。
3. **設置備選方案**：考慮到人員離職或休假，建議通過“角色”而非“個人”來分配審批任務。
