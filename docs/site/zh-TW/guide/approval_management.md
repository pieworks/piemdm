# 審批流程定義與管理

PieMDM 提供了高度可配置的審批引擎。您可以根據業務需求，為不同的實體（表）和操作（如新增、修改、刪除）定義個性化的審批流程。

## 1. 審批定義 (Approval Definition)

“審批定義”是流程的模板，它描述了一個完整的審批流如何運行。

### 1.1 基礎配置
- **定義名稱與編碼**：每一個審批流都有唯一的編碼（Code）和易於理解的名稱。
- **狀態管理**：
    - **草稿 (Draft)**：正在編輯中，不可被引用。
    - **激活 (Active)**：正式生效，可以被綁定到實體操作上。
    - **停用 (Inactive)**：暫時下線，已發起的流程將繼續執行，但新操作將不再觸發該流程。
- **發布與版本控制**：系統支持多版本管理。當您修改了已發布的審批流並選擇“重新發布”時，系統會生成新的版本號，確保流程變更的可追溯性。

### 1.2 審批平台
PieMDM 支持多種審批觸達方式：
- **自研審批 (Internal)**：直接在 PieMDM 網頁端進行處理。
- **飛書審批 (Feishu)**：系統可同步飛書的審批表單與節點，用戶直接在飛書對話框中完成審批。

## 2. 審批節點 (Approval Node)

一個審批流由多個節點有序組成。

### 2.1 節點類型
- **開始節點 (Start)**：流程的發起點，通常由提交數據的用戶觸發。
- **審批節點 (Approval)**：核心人工審核節點。
- **抄送節點 (CC)**：通知相關人員，僅限閱知，不影響流程流轉。
- **條件分支 (Condition)**：根據數據內容（如金額、所屬部門）自動路由到不同的審批分支。
- **結束節點 (End)**：流程的終點，標誌著數據正式生效。

### 2.2 審批人配置
您可以靈活定義每個節點的審批人：
- **指定人員**：通過用戶列表選擇具體人員。
- **指定角色**：例如“財務總監”，屬於該角色的所有用戶均可審批。
- **動態關係**：例如“直屬主管”、“部門負責人”。

## 3. 綁定實體操作 (Table Binding)

定義好審批流後，需要將其與具體的實體表操作關聯起來，才能發揮作用。

您可以在“模型管理 > 審批設置”或“流程管理 > 表綁定”中進行配置：
- **實體表**：選擇目標實體（如“供應商信息”）。
- **操作類型**：
    - **新增 (Create)**：新錄入數據是否需審批。
    - **修改 (Update)**：編輯已有數據是否需審批。
    - **刪除 (Delete)**：作廢數據是否需審批。
- **綁定流程**：選擇一個處於“激活”狀態的審批定義。

## 4. 流程發布機制

<callout emoji="🚀" background-color="light-green">
當您完成節點配置後，必須點擊“驗證並發布”。系統會檢查流程是否閉環（即是否有終點）、是否有孤立節點以及審批人配置是否有效。
</callout>

## 5. 常見問題

<callout emoji="❓" background-color="light-purple">
修改審批定義後，正在運行的任務會變嗎？
</callout>

不會。已經發起的審批實例將嚴格按照**發起時**的流程定義版本運行。只有新發起的申請才會使用最新發布的版本。

<callout emoji="❓" background-color="light-purple">
一個表可以綁定多個審批流嗎？
</callout>

針對同一種操作（如“修改”），一個表只能綁定一個**激活**的流程。但您可以針對“新增”和“修改”分別綁定不同的流程。
