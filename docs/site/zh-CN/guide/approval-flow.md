# 审批流管理

PieMDM 内置了强大的审批引擎，支持企业根据业务需求灵活配置审批流程。无论是物料主数据的创建、供应商档案的修改，还是财务数据的冻结，都可以通过审批流来确保数据的准确性和合规性。

同时也支持对接外部审批系统：
- 飞书 (已支持)
- 钉钉
- 企业微信
- 其他

## 核心概念

系统的审批架构主要由以下部分组成：
- **审批定义 (Approval Definition)**：流程的模板，定义了审批名称、关联表单和节点序列。
- **流程节点 (Approval Node)**：流程中的具体环节，规定了谁来审、怎么审。
- **审批实例 (Approval Instance)**：流程的具体执行记录，对应一张具体的审批单据。
- **审批任务 (Approval Task)**：分配给具体执行人的待办事项。

## 流程节点类型

在配置审批流时，您可以组合使用多种类型的节点：

| 节点类型 | 说明 |
| :--- | :--- |
| **开始节点 (START)** | 流程的入口，通常由申请人发起。 |
| **审批节点 (APPROVAL)** | 核心节点，需要审核人进行通过或驳回操作。 |
| **抄送节点 (CC)** | 告知相关人员，无需操作，仅供查阅。 |
| **条件节点 (CONDITION)** | 逻辑分支，根据表单数据自动选择路径（如：金额 > 10,000 走向经理审批）。 |
| **并行/合并节点** | 支持多个环节同时进行审批，并在汇合后继续。 |
| **结束节点 (END)** | 流程终点，通过后数据将正式生效。 |

## 审批方式

对于审批节点，您可以配置不同的决策模式：
- **或签 (OR)**：节点内的多名审批人，只需一人通过即可进入下一环节。
- **会签 (AND)**：节点内的所有审批人均需通过，流程方可继续。
- **顺序审批 (SEQUENTIAL)**：按照预定义的顺序，逐一进行审批。

## 审批人设置

审批人可以基于多种维度进行配置：
- **指定用户**：选择特定的系统用户。
- **指定角色**：分配给拥有特定角色（如“财务经理”）的所有用户。
- **上级领导**：动态获取申请人的直接或间接上级。
- **自选环节**：由上一环节的审批人临时指定下一环节的执行者。

## 数据流转机制

### 1. 草稿数据隔离
当一个表关联了审批流时，新增或修改的数据首先存储在“草稿状态”。此时数据在业务系统中不可见，仅在审批模块中流转。

### 2. 生效策略
- **审批通过**：流程到达“结束节点”且最终通过后，系统会自动将草稿数据同步到正式业务表中，主数据正式生效。
- **审批驳回**：流程终止，申请人可以根据审批意见修改后再次提交，或撤回申请。

## 最佳实践

1. **简化路径**：对于常规、低风险的操作，尽量缩短审批路径以提高效率。
2. **明确节点命名**：使用具有业务含义的节点名称（如“一审：部门主管”），方便参与者理解当前进度。
3. **设置备选方案**：考虑到人员离职或休假，建议通过“角色”而非“个人”来分配审批任务。
